<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pfitz Pace Tool</title>
  <style>
    :root {
      --bg: #0a0a0a;
      --card: #161616;
      --ink: #f4f4f4;
      --accent: #00c896;
      --muted: #888;
      --border: #333;
    }
    body {
      background: var(--bg);
      color: var(--ink);
      font-family: system-ui, sans-serif;
      padding: 2rem;
      line-height: 1.5;
      max-width: 1000px;
      margin: auto;
    }
    h1 {
      color: var(--accent);
      text-align: center;
    }
    select, input {
      padding: 0.4rem;
      background: var(--card);
      border: 1px solid var(--border);
      color: var(--ink);
      border-radius: 4px;
      width: 100%;
    }
    button {
      background: var(--accent);
      border: none;
      color: black;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
    }
    button:hover { opacity: 0.9; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .tab-buttons {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .tab-buttons button {
      margin: 0 0.25rem;
      background: var(--card);
      color: var(--ink);
      border: 1px solid var(--border);
    }
    .tab-buttons button.active {
      background: var(--accent);
      color: black;
      border: none;
    }
    .tab {
      background: var(--card);
      padding: 1rem 1.5rem;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border-bottom: 1px solid var(--border);
      padding: 0.4rem 0.5rem;
      text-align: left;
    }
    th { color: var(--accent); }
  </style>
</head>
<body>
  <h1>Pfitz Pace Tool</h1>

  <div class="tab-buttons">
    <button id="marathonTabBtn" class="active" onclick="showTab('marathonTab')">Marathon Calculator</button>
    <button id="frrTabBtn" onclick="showTab('frrTab')">FRR Calculator</button>
  </div>

  <!-- Marathon Tab -->
  <div id="marathonTab" class="tab">
    <h2>Marathon Calculator</h2>
    <p>Based on <i>Advanced Marathoning</i> by Pete Pfitzinger & Scott Douglas</p>

    <div class="grid">
      <label for="raceDist">Race Distance:</label>
      <select id="raceDist">
        <option value="5K">5K</option>
        <option value="10K">10K</option>
        <option value="Half Marathon">Half Marathon</option>
        <option value="Marathon" selected>Marathon</option>
      </select>

      <label for="raceTime">Race Time:</label>
      <input id="raceTime" placeholder="e.g. 3:45:00">
    </div>

    <div class="grid">
      <label for="maxHR">Max HR:</label>
      <input id="maxHR" placeholder="e.g. 190">
      <label for="restHR">Resting HR:</label>
      <input id="restHR" placeholder="e.g. 50">
    </div>

    <button onclick="calculateMarathon()">Calculate</button>

    <div id="marathonOutput"></div>
    <div id="marathonTraining"></div>
    <h3>Heart Rate Zones</h3>
    <table id="hrZones">
      <thead>
        <tr><th>Zone</th><th>% HRmax</th><th>BPM</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- FRR Tab -->
  <div id="frrTab" class="tab" style="display:none;">
    <h2>FRR Calculator</h2>
    <p>Based on <i>Faster Road Racing</i> by Pete Pfitzinger & Philip Latter</p>

    <div class="grid">
      <label for="frrDistance">Race Distance:</label>
      <select id="frrDistance">
        <option value="5K">5K</option>
        <option value="10K">10K</option>
        <option value="Half Marathon">Half Marathon</option>
      </select>

      <label for="frrTime">Race Time:</label>
      <input id="frrTime" placeholder="e.g. 45:00">
    </div>

    <div class="grid">
      <label for="frrMaxHR">Max HR:</label>
      <input id="frrMaxHR" placeholder="e.g. 190">
      <label for="frrRestHR">Resting HR:</label>
      <input id="frrRestHR" placeholder="e.g. 50">
    </div>

    <button onclick="calculateFRR()">Calculate</button>

    <div id="frrOutput"></div>
    <h3>Heart Rate Zones</h3>
    <table id="frrHRZones">
      <thead>
        <tr><th>Zone</th><th>% HRmax</th><th>BPM</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    function showTab(tabId) {
      document.getElementById('marathonTab').style.display = 'none';
      document.getElementById('frrTab').style.display = 'none';
      document.getElementById(tabId).style.display = 'block';

      document.getElementById('marathonTabBtn').classList.remove('active');
      document.getElementById('frrTabBtn').classList.remove('active');
      if (tabId === 'marathonTab') document.getElementById('marathonTabBtn').classList.add('active');
      else document.getElementById('frrTabBtn').classList.add('active');
    }

    function timeToSeconds(str) {
      if (!str) return NaN;
      const parts = str.split(':').map(Number);
      if (parts.length === 3) return parts[0]*3600 + parts[1]*60 + parts[2];
      if (parts.length === 2) return parts[0]*60 + parts[1];
      return Number(str);
    }

    function formatPace(secondsPerKm) {
      const m = Math.floor(secondsPerKm / 60);
      const s = Math.round(secondsPerKm % 60);
      return `${m}:${s.toString().padStart(2,'0')}`;
    }

    function calculateMarathon() {
      const distSel = document.getElementById('raceDist').value;
      const timeStr = document.getElementById('raceTime').value;
      const secs = timeToSeconds(timeStr);
      if (!secs) return alert('Enter a valid race time');

      const distances = { '5K':5000, '10K':10000, 'Half Marathon':21097.5, 'Marathon':42195 };
      const pace = secs / (distances[distSel]/1000);

      document.getElementById('marathonOutput').innerHTML = `
        <p><b>Pace:</b> ${formatPace(pace)} /km</p>
      `;

      // HR zones
      const maxHR = parseFloat(document.getElementById('maxHR').value);
      const restHR = parseFloat(document.getElementById('restHR').value);
      const hrTable = document.getElementById('hrZones').querySelector('tbody');
      hrTable.innerHTML = '';
      if (!isNaN(maxHR) && !isNaN(restHR)) {
        const zones = [
          ['Recovery', 0.70, 0.79],
          ['Endurance', 0.80, 0.89],
          ['Threshold', 0.90, 0.94],
          ['VO₂ Max', 0.95, 1.00]
        ];
        for (const [name, lo, hi] of zones) {
          const bpmLo = Math.round(maxHR * lo);
          const bpmHi = Math.round(maxHR * hi);
          const row = document.createElement('tr');
          row.innerHTML = `<td>${name}</td><td>${(lo*100).toFixed(0)}–${(hi*100).toFixed(0)}%</td><td>${bpmLo}–${bpmHi}</td>`;
          hrTable.appendChild(row);
        }
      }
    }

    function calculateFRR() {
      const dist = document.getElementById('frrDistance').value;
      const tStr = document.getElementById('frrTime').value;
      const secs = timeToSeconds(tStr);
      if (!secs) return alert('Enter a valid race time');

      const distances = { '5K':5000, '10K':10000, 'Half Marathon':21097.5 };
      const pace = secs / (distances[dist]/1000);

      document.getElementById('frrOutput').innerHTML = `
        <p><b>Pace:</b> ${formatPace(pace)} /km</p>
      `;

      // --- HR Zones for FRR ---
      const maxHR = parseFloat(document.getElementById('frrMaxHR').value);
      const restHR = parseFloat(document.getElementById('frrRestHR').value);
      const hrTable = document.getElementById('frrHRZones').querySelector('tbody');
      hrTable.innerHTML = '';
      if (!isNaN(maxHR) && !isNaN(restHR)) {
        const zones = [
          ['Recovery', 0.70, 0.79],
          ['Endurance', 0.80, 0.89],
          ['Threshold', 0.90, 0.94],
          ['VO₂ Max', 0.95, 1.00]
        ];
        for (const [name, lo, hi] of zones) {
          const bpmLo = Math.round(maxHR * lo);
          const bpmHi = Math.round(maxHR * hi);
          const row = document.createElement('tr');
          row.innerHTML = `<td>${name}</td><td>${(lo*100).toFixed(0)}–${(hi*100).toFixed(0)}%</td><td>${bpmLo}–${bpmHi}</td>`;
          hrTable.appendChild(row);
        }
      }
    }
  </script>
</body>
</html>
